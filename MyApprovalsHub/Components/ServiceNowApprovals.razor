@using System.IO
@using Azure.Core
@using Microsoft.Graph
@using MyApprovalsHub.Interfaces
@using MyApprovalsHub.Services
@inject TeamsFx teamsfx
@inject TeamsUserCredential teamsUserCredential


<ApprovalsCard ApprovalLogoUri="servicenow.png" ApprovalPending="@expensesTotal" />


@code {

      [Parameter]
    public string ApprovalEmail { get; set; }

    private int expensesTotal;

  

    protected override void OnInitialized()
    {

        IPendingApprovalService expenseService =  ServiceNowService.GetInstance();

        var expenses = expenseService.GetPendingApprovals(ApprovalEmail);

        expensesTotal = expenseService.PendingApprovals;

        ExpenseList.AddRange(expenses);

    }

}