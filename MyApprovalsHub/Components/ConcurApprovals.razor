@using System.IO
@using Azure.Core
@using Microsoft.Graph
@using MyApprovalsHub.Interfaces
@using MyApprovalsHub.Models
@using MyApprovalsHub.Services
@inject TeamsFx teamsfx
@inject TeamsUserCredential teamsUserCredential


<ApprovalsCard ApprovalLogoUri="concur.png" ApprovalPending="@expensesTotal" />


@code{

    [Parameter]
    public string ApprovalEmail { get; set; }

    private int expensesTotal;

  

    protected override void OnInitialized()
    {

        IPendingApprovalService expenseService = new ConcurService();

        var expenses = expenseService.GetPendingApprovals(ApprovalEmail);

        expensesTotal = expenses.Count();

        ExpenseList.AddRange(expenses);

    }

}